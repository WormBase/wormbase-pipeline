
package GenomeBrowser::Descriptions;

my $curated_descriptions_canned = {
    'ascaris_suum' => {
        'SRP013573' => {
            'SRR504550' => '24hr',
            'SRR504551' => '46hr',
            'SRR504552' => '64hr',
            'SRR504553' => 'larvae',
            'SRR504554' => 'intestine',
            'SRR504555' => 'muscle',
            'SRR504556' => [
                'male carcass',
'male carcass (whole male with testis, spermatids, and intestine removed)'
            ],
            'SRR504557' => [
                'male carcass',
'male carcass (whole male with testis, spermatids, and intestine removed)'
            ],
            'SRR504558' => [
                'male carcass',
'male carcass (whole male with testis, spermatids, and intestine removed)'
            ],
            'SRR504559' => [
                'female carcass',
'female carcass (whole female with ovary and oviduct, uterus with embryos, and intestine removed)'
            ],
            'SRR504560' => [
                'female carcass',
'female carcass (whole female with ovary and oviduct, uterus with embryos, and intestine removed)'
            ],
            'SRR504561' => [
                'female carcass',
'female carcass (whole female with ovary and oviduct, uterus with embryos, and intestine removed)'
            ],
            'SRR504562' => 'testis',
            'SRR504563' => 'testis',
            'SRR504564' => 'ovary'
        }
    },
    'brugia_malayi' => {
        'ERP000948' => {
            'ERR048961' => 'Adult male',
            'ERR048962' => 'Adult female',
            'ERR048963' => 'L4',
            'ERR048965' => 'Microfilariae',
            'ERR048967' => 'Eggs/embryos',
            'ERR048969' => 'Eggs/embryos',
            'ERR048970' => 'Adult female',
            'ERR048971' => 'L4',
            'ERR048972' => 'Adult female',
            'ERR048973' => 'L4',
            'ERR048974' => 'L3'
        },
        'SRP063061' => {
            'SRR2225857' => [
                'Upon dissection',
                'RNA extraction immediately upon jird dissection'
            ],
            'SRR2225858' => [
                'Upon dissection',
                'RNA extraction immediately upon jird dissection'
            ],
            'SRR2225859' => [
                'Upon dissection',
                'RNA extraction immediately upon jird dissection'
            ],
            'SRR2225860' => [
                'Upon dissection',
                'RNA extraction immediately upon jird dissection'
            ],
            'SRR2225861' => [
                'Upon dissection',
                'RNA extraction immediately upon jird dissection'
            ],
            'SRR2225862' => [
                'Upon dissection',
                'RNA extraction immediately upon jird dissection'
            ],
            'SRR2225863' => [ 'Upon arrival', 'RNA extraction upon arrival' ],
            'SRR2225864' => [ 'Upon arrival', 'RNA extraction upon arrival' ],
            'SRR2225865' => [ 'Upon arrival', 'RNA extraction upon arrival' ],
            'SRR2225866' => [ 'Upon arrival', 'RNA extraction upon arrival' ],
            'SRR2225867' => [ 'Upon arrival', 'RNA extraction upon arrival' ],
            'SRR2225868' => [ 'Upon arrival', 'RNA extraction upon arrival' ],
            'SRR2225869' => [ '48h', 'RNA extraction after 48h in culture' ],
            'SRR2225870' => [ '48h', 'RNA extraction after 48h in culture' ],
            'SRR2225871' => [ '48h', 'RNA extraction after 48h in culture' ],
            'SRR2225872' => [ '48h', 'RNA extraction after 48h in culture' ],
            'SRR2225873' => [ '48h', 'RNA extraction after 48h in culture' ],
            'SRR2225874' => [ '48h', 'RNA extraction after 48h in culture' ],
            'SRR2225875' =>
              [ '5 days', 'RNA extraction after 5 days in culture' ],
            'SRR2225876' =>
              [ '5 days', 'RNA extraction after 5 days in culture' ],
            'SRR2225877' =>
              [ '5 days', 'RNA extraction after 5 days in culture' ],
            'SRR2225878' =>
              [ '5 days', 'RNA extraction after 5 days in culture' ],
            'SRR2225879' =>
              [ '5 days', 'RNA extraction after 5 days in culture' ],
            'SRR2225880' =>
              [ '5 days', 'RNA extraction after 5 days in culture' ]
        },
        'SRP064921' => {
            'SRR2673316' => '20-hydroxyecdysone-treated females',
            'SRR3292163' => '20-hydroxyecdysone-treated females',
            'SRR3292166' => '20-hydroxyecdysone-treated females'
        },
        'SRP068692' => {
            'SRR3110748' => 'Adult female',
            'SRR3111433' => 'Adult female',
            'SRR3111490' => 'Adult female',
            'SRR3111494' => 'Adult female',
            'SRR3111497' => 'Adult male',
            'SRR3111501' => 'Adult male',
            'SRR3111507' => 'Embryos',
            'SRR3111512' => 'Embryos',
            'SRR3111516' =>
              [ '3dpi mixed', '3 days post-infection of host (mixed sex)' ],
            'SRR3111520' =>
              [ '3dpi mixed', '3 days post-infection of host (mixed sex)' ],
            'SRR3111547' =>
              [ '4dpi mixed', '4 days post-infection of host (mixed sex)' ],
            'SRR3111569' =>
              [ '4dpi mixed', '4 days post-incubation of host (mixed sex)' ],
            'SRR3111577' =>
              [ '8dpi mixed', '8 days post-infection of host (mixed sex)' ],
            'SRR3111580' =>
              [ '8dpi mixed', '8 days post-infection of host (mixed sex)' ],
            'SRR3111628' =>
              [ '20dpi male', '20 days post-infection of host (male)' ],
            'SRR3111631' =>
              [ '20dpi male', '20 days post-infection of host (male)' ],
            'SRR3111635' =>
              [ '24dpi female', '24 days post-infection of host (female)' ],
            'SRR3111637' =>
              [ '24dpi female', '24 days post-infection of host (female)' ],
            'SRR3111641' => [ 'Immature MF', 'Immature microfilariae' ],
            'SRR3111644' => [ 'Mature MF',   'Mature microfilariae' ],
            'SRR3111645' => [ 'Mature MF',   'Mature microfilariae' ],
            'SRR5189260' => [
                '18hpi vector mixed',
                '18 hours post-infection of vector (mixed sex)'
            ],
            'SRR5189940' => [
                '18hpi vector mixed',
                '18 hours post-infection of vector (mixed sex)'
            ],
            'SRR5189941' =>
              [ '4dpi mixed', '4 days post-infection of vector (mixed sex)' ],
            'SRR5189942' =>
              [ '4dpi mixed', '4 days post-infection of vector (mixed sex)' ],
            'SRR5190125' => [
                '8dpi vector mixed',
                '8 days post-infection of vector (mixed sex)'
            ],
            'SRR5190126' => [
                '8dpi vector mixed',
                '8 days post-infection of vector (mixed sex)'
            ],
            'SRR5190127' => [
                '8dpi vector mixed',
                '8 days post-infection of vector (mixed sex)'
            ]
        }
    },
    'echinococcus_granulosus' => {
        'ERP001209' => {
            'ERR233393' => 'Non-activated protoscolex'
        },
        'ERP004459' => {
            'ERR337909' => 'Metacestode, cyst wall',
            'ERR337912' => 'Non-activated protoscolex',
            'ERR337922' => 'Metacestode, cyst wall',
            'ERR337925' => 'Non-activated protoscolex',
            'ERR337937' => 'Non-activated protoscolex',
            'ERR337949' => 'Non-activated protoscolex',
            'ERR337961' => 'Non-activated protoscolex',
            'ERR337973' => 'Non-activated protoscolex'
        }
    },
    'echinococcus_multilocularis' => {
        'ERP001209' => {
            'ERR233394' => 'Activated protoscolex',
            'ERR233395' => 'Non-activated protoscolex',
            'ERR233396' => 'Primary cells (stage 1)',
            'ERR233397' =>
              [ 'Primary cells (stage 2)', 'Primary cells 11 days (stage 2)' ],
            'ERR233398' => [
                'Metacestode vesicle',
                'Metacestode vesicle, without brood chambers'
            ]
        },
        'ERP004459' => {
            'ERR337903' =>
              [ 'Primary cells (stage 1)', 'Primary cells 48 h (stage 1)' ],
            'ERR337904' =>
              [ 'Primary cells (stage 2)', 'Primary cells 7 days (stage 2)' ],
            'ERR337905' =>
              [ 'Primary cells (stage 3)', 'Primary cells 22 days (stage 3)' ],
            'ERR337906' => [
                'Metacestode, vesicle w/o brood chambers',
                'Metacestode, vesicle without brood chambers'
            ],
            'ERR337907' => [
                'Metacestode, aerobic',
                'Metacestode, aerobic co-culture with Rh feeder cells'
            ],
            'ERR337910' =>
              [ 'Metacestode, axenic', 'Metacestode, axenic culture' ],
            'ERR337911' => [
                'Metacestode, axenic + HU',
                'Metacestode, axenic culture with hydroxyurea'
            ],
            'ERR337913' => 'Non-activated protoscolex',
            'ERR337914' => 'Activated protoscolex',
            'ERR337916' =>
              [ 'Primary cells (stage 1)', 'Primary cells 48 h (stage 1)' ],
            'ERR337917' =>
              [ 'Primary cells (stage 2)', 'Primary cells 7 days (stage 2)' ],
            'ERR337918' =>
              [ 'Primary cells (stage 3)', 'Primary cells 22 days (stage 3)' ],
            'ERR337919' => [
                'Metacestode, vesicle w/o brood chambers',
                'Metacestode, vesicle without brood chambers'
            ],
            'ERR337920' => [
                'Metacestode, aerobic',
                'Metacestode, aerobic co-culture with Rh feeder cells'
            ],
            'ERR337923' =>
              [ 'Metacestode, axenic', 'Metacestode, axenic culture' ],
            'ERR337924' => [
                'Metacestode, axenic + HU',
                'Metacestode, axenic culture with hydroxyurea'
            ],
            'ERR337926' => 'Non-activated protoscolex',
            'ERR337927' => 'Activated protoscolex',
            'ERR337929' =>
              [ 'Primary cells (stage 1)', 'Primary cells 48 h (stage 1)' ],
            'ERR337930' =>
              [ 'Primary cells (stage 2)', 'Primary cells 9 days (stage 2)' ],
            'ERR337931' =>
              [ 'Primary cells (stage 3)', 'Primary cells 16 days (stage 3)' ],
            'ERR337932' => [
                'Metacestode, vesicle w/o brood chambers',
                'Metacestode, vesicle without brood chambers'
            ],
            'ERR337933' => [
                'Metacestode, aerobic',
                'Metacestode, aerobic co-culture with Rh feeder cells'
            ],
            'ERR337934' =>
              [ 'Metacestode', 'Metacestode, extracted from jird' ],
            'ERR337935' =>
              [ 'Metacestode, axenic', 'Metacestode, axenic culture' ],
            'ERR337936' => [
                'Metacestode, axenic + HU',
                'Metacestode, axenic culture with hydroxyurea'
            ],
            'ERR337938' => 'Non-activated protoscolex',
            'ERR337939' => 'Activated protoscolex',
            'ERR337941' =>
              [ 'Primary cells (stage 1)', 'Primary cells 48 h (stage 1)' ],
            'ERR337942' =>
              [ 'Primary cells (stage 2)', 'Primary cells 9 days (stage 2)' ],
            'ERR337943' =>
              [ 'Primary cells (stage 3)', 'Primary cells 16 days (stage 3)' ],
            'ERR337944' => [
                'Metacestode, vesicle w/o brood chambers',
                'Metacestode, vesicle without brood chambers'
            ],
            'ERR337945' => [
                'Metacestode, aerobic',
                'Metacestode, aerobic co-culture with Rh feeder cells'
            ],
            'ERR337946' =>
              [ 'Metacestode', 'Metacestode, extracted from jird' ],
            'ERR337947' =>
              [ 'Metacestode, axenic', 'Metacestode, axenic culture' ],
            'ERR337948' => [
                'Metacestode, axenic + HU',
                'Metacestode, axenic culture with hydroxyurea'
            ],
            'ERR337950' => 'Non-activated protoscolex',
            'ERR337951' => 'Activated protoscolex',
            'ERR337953' =>
              [ 'Primary cells (stage 1)', 'Primary cells 48 h  (stage 1)' ],
            'ERR337954' =>
              [ 'Primary cells (stage 2)', 'Primary cells 11 days (stage 2)' ],
            'ERR337955' =>
              [ 'Primary cells (stage 3)', 'Primary cells 21 days (stage 3)' ],
            'ERR337956' => [
                'Metacestode, vesicle w/o brood chambers',
                'Metacestode, vesicle without brood chambers'
            ],
            'ERR337957' => [
                'Metacestode, aerobic',
                'Metacestode, aerobic co-culture with Rh feeder cells'
            ],
            'ERR337958' =>
              [ 'Metacestode', 'Metacestode, extracted from jird' ],
            'ERR337959' =>
              [ 'Metacestode, axenic', 'Metacestode, axenic culture' ],
            'ERR337960' => [
                'Metacestode, axenic + HU',
                'Metacestode, axenic culture with hydroxyurea'
            ],
            'ERR337962' => 'Non-activated protoscolex',
            'ERR337963' => 'Activated protoscolex',
            'ERR337965' =>
              [ 'Primary cells (stage 1)', 'Primary cells 48 h  (stage 1)' ],
            'ERR337966' =>
              [ 'Primary cells (stage 2)', 'Primary cells 11 days (stage 2)' ],
            'ERR337967' =>
              [ 'Primary cells (stage 3)', 'Primary cells 21 days (stage 3)' ],
            'ERR337968' => [
                'Metacestode, vesicle w/o brood chambers',
                'Metacestode, vesicle without brood chambers'
            ],
            'ERR337969' => [
                'Metacestode, aerobic',
                'Metacestode, aerobic co-culture with Rh feeder cells'
            ],
            'ERR337970' =>
              [ 'Metacestode', 'Metacestode, extracted from jird' ],
            'ERR337971' =>
              [ 'Metacestode, axenic', 'Metacestode, axenic culture' ],
            'ERR337972' => [
                'Metacestode, axenic + HU',
                'Metacestode, axenic culture with hydroxyurea'
            ],
            'ERR337974' => 'Non-activated protoscolex',
            'ERR337975' => 'Activated protoscolex'
        }
    },
    'fasciola_hepatica' => {
        'ERP006566' => {
            'ERR576952' => 'Adult',
            'ERR576953' => 'Adult',
            'ERR576954' => 'Egg',
            'ERR576955' => 'Egg',
            'ERR576956' => 'Juveniles',
            'ERR576957' => 'Juveniles',
            'ERR576958' => [ 'Metacercariae', 'Metacercariae 0hrs' ],
            'ERR576959' => [ 'Metacercariae', 'Metacercariae 0hrs' ],
            'ERR576960' => 'Newly emerged juveniles 1hr',
            'ERR576961' => 'Newly emerged juveniles 1hr',
            'ERR576962' => 'Newly emerged juveniles 3hrs',
            'ERR576963' => 'Newly emerged juveniles 3hrs',
            'ERR576964' => [ 'Metacercariae', 'Metacercariae 0hrs' ],
            'ERR576965' => [ 'Metacercariae', 'Metacercariae 0hrs' ],
            'ERR576966' => 'Newly emerged juveniles 1hr',
            'ERR576967' => 'Newly emerged juveniles 24hrs',
            'ERR576968' => 'Newly emerged juveniles 24hrs',
            'ERR576969' => 'Newly emerged juveniles 3hrs'
        },
        'ERP006623' => {
            'ERR577156' => [ 'Metacercariae', 'Metacercariae 0hrs' ],
            'ERR577157' => 'Adult',
            'ERR577158' => 'Egg',
            'ERR577159' => 'Juveniles',
            'ERR577160' => 'Adult'
        }
    },
    'haemonchus_contortus' => {
        'SRP026668' => {
            'SRR928055' => 'Adult female',
            'SRR928056' => 'Adult male',
            'SRR928057' => 'Egg',
            'SRR928058' => 'L1',
            'SRR928059' => 'L2',
            'SRR928060' => 'L2',
            'SRR928061' => 'L3',
            'SRR928062' => 'L4 female',
            'SRR928063' => 'L4 male'
        }
    },
    'hymenolepis_microstoma' => {
        'ERP001238' => {
            'ERR225717' => 'Adult, whole worm',
            'ERR225718' => [ 'Larva', '5 days old mid-metamorphosis larvae' ]
        },
        'ERP004459' => {
            'ERR225719' => 'Adult, scolex',
            'ERR225720' => 'Adult, scolex',
            'ERR225721' => 'Adult, scolex',
            'ERR225722' => 'Adult, mid-section',
            'ERR225723' => 'Adult, mid-section',
            'ERR225724' => 'Adult, mid-section',
            'ERR225725' => 'Adult, posterior',
            'ERR225726' => 'Adult, posterior',
            'ERR225727' => 'Adult, posterior',
            'ERR225728' => [ 'Adult, whole', 'Adult, whole worm' ],
            'ERR225729' => [ 'Adult, whole', 'Adult, whole worm' ],
            'ERR225730' => [ 'Adult, whole', 'Adult, whole worm' ],
            'ERR337915' => [
                'mid-metamorphosis larvae',
                'Appr. 5 days old mid-metamorphosis larvae'
            ],
            'ERR337928' => [
                'mid-metamorphosis larvae',
                'Appr. 5 days old mid-metamorphosis larvae'
            ],
            'ERR337940' => [
                'mid-metamorphosis larvae',
                'Appr. 5 days old mid-metamorphosis larvae'
            ],
            'ERR337952' => [
                'mid-metamorphosis larvae',
                'Appr. 5 days old mid-metamorphosis larvae'
            ],
            'ERR337964' => [
                'mid-metamorphosis larvae',
                'Appr. 5 days old mid-metamorphosis larvae'
            ],
            'ERR337976' => [
                'mid-metamorphosis larvae',
                'Appr. 5 days old mid-metamorphosis larvae'
            ]
        }
    },
    'onchocerca_volvulus' => {
        'ERP001350' => {
            'ERR225731' => [ 'L3', 'Sample from Cameroon rainforest L3' ],
            'ERR225732' => [ 'L3', 'Sample from Cameroon rainforest L3' ],
            'ERR225733' => [ 'L3', 'Sample from Cameroon rainforest L3' ],
            'ERR225734' => 'Adult male',
            'ERR225735' => [ 'L2', 'L2 mixed sex' ],
            'ERR225736' => 'Microfilariae',
            'ERR225737' => 'Microfilariae',
            'ERR485008' => [ 'Adult female', 'Adult female from nodules' ],
            'ERR485009' => 'Adult female',
            'ERR485010' => [ 'Adult females', 'Four adult females' ],
            'ERR570055' => [ 'Adult female', 'Adult female from nodules' ],
            'ERR570056' => [ 'Adult females', 'Four adult females' ]
        },
        'SRP056861' => {
            'SRR1952268' => 'Adult female',
            'SRR1952316' => 'Adult female',
            'SRR1952319' => [ 'Adult male', 'Four adult males' ],
            'SRR1952348' => 'Adult female',
            'SRR1952349' => 'Adult female',
            'SRR1952351' => 'Adult female',
            'SRR1952458' => 'Adult female',
            'SRR1952460' => 'Adult female',
            'SRR1952463' => 'Adult female'
        }
    },
    'schistosoma_mansoni' => {
        'ERP000427' => {
            'ERR022872' => 'Cercariae',
            'ERR022873' => 'Adult',
            'ERR022874' => [ 'Somule 3hrs', 'Somule 3hrs post-infection' ],
            'ERR022875' => 'Cercarial tail',
            'ERR022876' => [ 'Somule 3hrs', 'Somule 3hrs post-infection' ],
            'ERR022877' => 'Cercariae',
            'ERR022878' => 'Cercariae',
            'ERR022879' => [ 'Somule 3hrs', 'Somule 3hrs post-infection' ],
            'ERR022880' => [ 'Somule 3hrs', 'Somule 3hrs post-infection' ],
            'ERR022881' => [ 'Somule 24hrs', 'Somule 24hrs post-infection' ],
            'ERR022882' => [ 'Somule 24hrs', 'Somule 24hrs post-infection' ],
            'ERR022883' => [ 'Somule 24hrs', 'Somule 24hrs post-infection' ]
        },
        'ERP003608' => {
            'ERR582645' => [
                'Male, mixed-sex, no treatment',
                'Male control (no treatment) from mixed-sex infection'
            ],
            'ERR582646' => [
                'Male, single-sex, no treatment',
                'Male control (no treatment) from single-sex infection'
            ],
            'ERR582647' => [
                'Male, worm pair, no treatment',
                'Male control (no treatment) from worm-pair'
            ],
            'ERR582648' => [
                'Female, mixed-sex, treated',
                'Female treated with TGF beta from mixed-sex infection'
            ],
            'ERR582649' => [
                'Female, single-sex, treated',
                'Female treated with TGF beta from single-sex infection'
            ],
            'ERR582650' => [
                'Female, worm-pair, treated',
                'Female treated with TGF beta from worm-pair'
            ],
            'ERR582651' => [
                'Female, mixed-sex, no treatment',
                'Female control (no treatment) from mixed-sex infection'
            ],
            'ERR582652' => [
                'Female, single-sex, no treatment',
                'Female control (no treatment) from single-sex infection'
            ],
            'ERR582653' => [
                'Female, worm pair, no treatment',
                'Female control (no treatment) from worm-pair'
            ],
            'ERR582654' => [
                'Male, mixed-sex, treated',
                'Male treated with TGF beta from mixed-sex infection'
            ],
            'ERR582655' => [
                'Male, single-sex, treated',
                'Male treated with TGF beta from single-sex infection'
            ],
            'ERR582656' => [
                'Male, worm-pair, treated',
                'Male treated with TGF beta from worm-pair'
            ]
        },
        'SRP017443' => {
            'SRR629227' => [ 'Non-irradiated', 'Non-irradiated male control' ],
            'SRR629228' => [ 'Non-irradiated', 'Non-irradiated male control' ],
            'SRR629229' => [ 'Non-irradiated', 'Non-irradiated male control' ],
            'SRR629230' => [ 'Irradiated',     'Irradiated male' ],
            'SRR629231' => [ 'Irradiated',     'Irradiated male' ],
            'SRR629232' => [ 'Irradiated',     'Irradiated male' ]
        },
        'SRP026308' => {
            'SRR922067' => 'Miracidia',
            'SRR922068' => 'Sporocyst'
        },
        'SRP032348' => {
            'SRR1020294' => 'Oxamniquine resistant',
            'SRR1020295' => 'Oxamniquine resistant',
            'SRR1020296' => 'Oxamniquine resistant',
            'SRR1020297' => 'Oxamniquine susceptible',
            'SRR1020298' => 'Oxamniquine susceptible'
        },
        'SRP042222' => {
            'SRR1346220' => 'Adult virgin females',
            'SRR1346221' =>
              [ 'Adult virgin females', 'Previously fecund females' ],
            'SRR1346222' => [ 'Adult virgin females', 'Adult fecund females' ]
        }
    },
    'strongyloides_ratti' => {
        'ERP001672' => {
            'ERR225783' => 'Free living adult',
            'ERR225784' => 'L3'
        },
        'ERP002187' => {
            'ERR299168' => 'Parasitic female',
            'ERR299169' => 'Parasitic female',
            'ERR299170' => 'Parasitic female',
            'ERR299171' => 'Free-living female',
            'ERR299172' => 'Free-living female',
            'ERR299173' => 'Free-living female',
            'ERR299174' => 'Parasitic female',
            'ERR299175' => 'Parasitic female',
            'ERR299176' => 'Parasitic female',
            'ERR299177' => 'Free-living female',
            'ERR299178' => 'Free-living female',
            'ERR299179' => 'Free-living female'
        }
    },
    'strongyloides_stercoralis' => {
        'ERP001556' => {
            'ERR146941' => [
                'Free-living females',
                'Young gravid free-living females with 1-6 eggs per gonadal arm'
            ],
            'ERR146942' => [
                'Free-living females',
                'Young gravid free-living females with 1-6 eggs per gonadal arm'
            ],
            'ERR146943' => [
                'Free-living females',
                'Young gravid free-living females with 1-6 eggs per gonadal arm'
            ],
            'ERR146944' =>
              [ 'L3+', 'In vivo activated third-stage larvae, female' ],
            'ERR146945' =>
              [ 'L3+', 'In vivo activated third-stage larvae, female' ],
            'ERR146946' =>
              [ 'L3+', 'In vivo activated third-stage larvae, female' ],
            'ERR146947' => [ 'L3i', 'Infectious female third stage larvae' ],
            'ERR146948' => [ 'L3i', 'Infectious female third stage larvae' ],
            'ERR146949' => [ 'L3i', 'Infectious female third stage larvae' ],
            'ERR146950' =>
              [ 'Post free-living L1', 'Post free-living female L1' ],
            'ERR146951' =>
              [ 'Post free-living L1', 'Post free-living female L1' ],
            'ERR146952' =>
              [ 'Post free-living L1', 'Post free-living female L1' ],
            'ERR146953' => [
                'Post parasitic L1',
                'Post parasitic first stage larvae, mixed sex'
            ],
            'ERR146954' => [
                'Post parasitic L1',
                'Post parasitic first stage larvae, mixed sex'
            ],
            'ERR146955' => [
                'Post parasitic L1',
                'Post parasitic first stage larvae, mixed sex'
            ],
            'ERR146956' => [
                'Post parasitic L3',
'Post parasitic heterogonically developing third stage larvae, female enriched'
            ],
            'ERR146957' => [
                'Post parasitic L3',
'Post parasitic heterogonically developing third stage larvae, female enriched'
            ],
            'ERR146958' => [
                'Post parasitic L3',
'Post parasitic heterogonically developing third stage larvae, female enriched'
            ],
            'ERR146959' => [ 'Parasitic females', 'Gravid parasitic female' ],
            'ERR146960' => [ 'Parasitic females', 'Gravid parasitic female' ],
            'ERR146961' => [ 'Parasitic females', 'Gravid parasitic female' ]
        },
        'ERP004559' => {
            'ERR406847' => [ 'M9 buffer', 'L3i, treated with 1x M9 Buffer' ],
            'ERR406848' =>
              [ 'delta(7)-DA', 'L3i, treated with delta(7)-dafachronic acid' ],
            'ERR406849' => [
                'DMEM',
'L3i, treated with 1x DMEM (supplemented with L-glutamine, glucose, and sodium pyruvate)'
            ],
            'ERR406850' => [
                '8-bromo-3\',5\'-cyclic GMP',
                'L3i, treated with 8-bromo-cyclic guanosine monophosphate'
            ],
            'ERR406851' => [
                '8-bromo-3\',5\'-cyclic GMP',
                'L3i, treated with 8-bromo-cyclic guanosine monophosphate'
            ],
            'ERR406852' => [ 'No treatment', 'L3i, no treatment' ],
            'ERR406853' => [ 'M9 buffer',    'L3i, treated with 1x M9 Buffer' ],
            'ERR406854' =>
              [ 'delta(7)-DA', 'L3i, treated with delta(7)-dafachronic acid' ],
            'ERR406855' => [
                'DMEM',
'L3i, treated with 1x DMEM (supplemented with L-glutamine, glucose, and sodium pyruvate)'
            ],
            'ERR406856' =>
              [ 'delta(7)-DA', 'L3i, treated with delta(7)-dafachronic acid' ],
            'ERR406857' => [
                'DMEM',
'L3i, treated with 1x DMEM (supplemented with L-glutamine, glucose, and sodium pyruvate)'
            ],
            'ERR406858' => [ 'M9 buffer',    'L3i, treated with 1x M9 Buffer' ],
            'ERR406859' => [ 'No treatment', 'L3i, no treatment' ],
            'ERR406860' => [
                'DMEM',
'L3i, treated with 1x DMEM (supplemented with L-glutamine, glucose, and sodium pyruvate)'
            ],
            'ERR406861' => [ 'No treatment', 'L3i, no treatment' ],
            'ERR406862' => [ 'M9 buffer',    'L3i, treated with 1x M9 Buffer' ],
            'ERR406863' => [
                '8-bromo-3\',5\'-cyclic GMP',
                'L3i, treated with 8-bromo-cyclic guanosine monophosphate'
            ],
            'ERR406865' => [ 'No treatment', 'L3i, no treatment' ],
            'ERR406866' =>
              [ 'delta(7)-DA', 'L3i, treated with delta(7)-dafachronic acid' ],
            'ERR406867' => [
                '8-bromo-3\',5\'-cyclic GMP',
                'L3i, treated with 8-bromo-cyclic guanosine monophosphate'
            ]
        }
    },
    'trichuris_muris' => {
        'ERP002000' => {
            'ERR279671' => [ 'Adult female',    'Adult female, whole' ],
            'ERR279672' => [ 'Adult male',      'Adult male, whole' ],
            'ERR279673' => [ 'L3',              'L3 stage' ],
            'ERR279674' => [ 'L3',              'L3 stage' ],
            'ERR279675' => [ 'L3',              'L3 stage' ],
            'ERR279676' => [ 'Adult mixed sex', 'Adult mixed sex, whole' ],
            'ERR279677' => [ 'Adult whole',     'Adult mixed sex, whole' ],
            'ERR279678' => [ 'Adult mixed sex', 'Adult mixed sex, whole' ],
            'ERR279679' => [ 'Adult male',      'Adult male, whole' ],
            'ERR279680' => [ 'Adult male',      'Adult male, whole' ],
            'ERR279681' => [ 'Adult female',    'Adult female, whole' ],
            'ERR279682' => [ 'Adult female',    'Adult female, whole' ],
            'ERR279683' => [
                'Adult mixed anteriors',
                'Adult mixed sex anteriors (intestinal phase)'
            ],
            'ERR279684' => [
                'Adult mixed anteriors',
                'Adult mixed sex anteriors (intestinal phase)'
            ],
            'ERR279685' => [
                'Adult female anteriors',
                'Adult female anteriors (intestinal phase)'
            ],
            'ERR279686' => [
                'Adult female posteriors',
                'Adult female posteriors (lumenal phase)'
            ],
            'ERR279687' => [
                'Adult female posteriors',
                'Adult female posteriors (lumenal phase)'
            ],
            'ERR279688' => [
                'Adult female posteriors',
                'Adult female posteriors (lumenal phase)'
            ],
            'ERR279689' => [
                'Adult male posteriors',
                'Adult male posteriors (lumenal phase)'
            ],
            'ERR279690' => [
                'Adult male posteriors',
                'Adult male posteriors (lumenal phase)'
            ],
            'ERR279691' => [
                'Adult male posteriors',
                'Adult male posteriors (lumenal phase)'
            ],
            'ERR279692' => [ 'L2', 'L2 stage' ]
        }
    }
};

sub new {
    my ( $class, $species, $curated_descriptions ) = @_;
    return bless {
        species => $species,
        curated => $curated_descriptions
          || $curated_descriptions_canned->{$species},
    }, $class;
}

sub run_description_from_sample_name {
    my ( $species, $sample_name ) = @_;
    ( my $cies = $species ) =~ s/.*_//;
    return "" unless $sample_name;
    return ""
      if (  $cies
        and $sample_name =~ /$cies/i
        and $sample_name =~ /sample from/i );
    return "" if ( scalar( split /\W+/, $sample_name ) == 1 );
    return "" if $sample_name =~ /private/;
    return "" if length($sample_name) < 10;
    return $sample_name;
}

# if some of these types can be made nicer in labels,
# e.g. if they have _, add some code that prettifies them
my @types_that_help_explain_values = qw/strain/;

sub run_description_from_factors {
    my ( $factors, $attributes ) = @_;
    my @result_short;
    my @result_full;

    for my $t (@$factors) {
        ( my $v = $attributes->{$t} ) or next;
        push @result_short, $v;
        if ( grep { $_ eq $t } @types_that_help_explain_values ) {
            push @result_full, "$t $v";
        }
        else {
            push @result_full, $v;
        }
    }
    return "" unless @result_short and @result_full;
    return [ join( ", ", @result_short ), join( ", ", @result_full ) ];
}

sub _get_run_description {
    my ( $self, $study_id, $run_id, $factors, $attributes ) = @_;
    return (
        $self->{curated}{$study_id}{$run_id}
          or run_description_from_sample_name( $self->{species},
            $attributes->{sample_name} )
          or run_description_from_factors( $factors, $attributes )
          or ""
    );
}

sub run_description {
    my ( $self, $study_id, $run_id, $factors, $attributes ) = @_;
    my $r = _get_run_description(@_);
    return map { "$run_id: $_" } @$r if ref $r eq 'ARRAY';
    return "$run_id: $r", "$run_id: $r", if $r;
    my $species = $self->{species};
    $species =~ s/_/ /g;
    $species = ucfirst($species);
    return "$run_id", "$run_id: sample from $species";
}

# Do we also want to curate these?
sub study_description {
    my ( $self, $study_id, $study_attributes ) = @_;
    return (
             $study_attributes->{"Study description"}
          or $study_attributes->{study}
          or $study_id
          or "$species study"
    );
}
1;
